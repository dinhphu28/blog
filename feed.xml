<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://www.dinhphu28.com/feed.xml" rel="self" type="application/atom+xml"/><link href="https://www.dinhphu28.com/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-05-30T08:04:36+00:00</updated><id>https://www.dinhphu28.com/feed.xml</id><title type="html">Dinh Phu Nguyen dinhphu28</title><subtitle>Dinh Phu Nguyen also know as dinhphu28 is a Software Engineer with high level experience in Java - Spring Boot, RESTful Web Service and software development. </subtitle><entry><title type="html">P2P - UDP Hole Punching</title><link href="https://www.dinhphu28.com/blog/2024/udp-hole-punching/" rel="alternate" type="text/html" title="P2P - UDP Hole Punching"/><published>2024-11-29T04:59:00+00:00</published><updated>2024-11-29T04:59:00+00:00</updated><id>https://www.dinhphu28.com/blog/2024/udp-hole-punching</id><content type="html" xml:base="https://www.dinhphu28.com/blog/2024/udp-hole-punching/"><![CDATA[<h3 id="introduction">Introduction</h3> <p>UDP hole punching is a technique for establishing bidirectional UDP connections between two networked devices behind NATs.</p> <p>But this technique is not always applicable because of multiple types of NATs.</p> <p>In this article, we will discuss the UDP hole punching concept and how it works.</p> <h3 id="what-is-nat">What is NAT?</h3> <p>Because of the limited availability of IPv4, Network Address Translation (NAT) was introduced to allow multiple devices to share a single public IP address.</p> <p>NAT remaps the private IP:port of devices in private networks to a public IP:port.</p> <p>There are multiple types of NATs, but for simplicity, we can categorize them into 2 types: Symmetric and anything else.</p> <ul> <li>Symmetric NAT remaps the public port depending on the endpoint.</li> <li>Other types of NATs are independent.</li> </ul> <h3 id="how-does-udp-hole-punching-work">How does UDP hole punching work?</h3> <p>This technique is originally to solve the firewall problem, because this problem is about NAT &amp; firewall. So we assume that the NAT is include firewall.</p> <p>Not as TCP, UDP is connectionless and doesn’t have a handshake mechanism. So when we send a packet out, it doesn’t care that it will reach the destination or not, and any packet coming back is considered as a response.</p> <p>Assume that we have known public IP:port of A and B.</p> <p>Idea of UDP hole punching is tricking NATs to allow incoming packets from the destination. There are 2 step to archive this:</p> <ul> <li>A sends a packet to B (this packet will be lost because B is also behind NAT)</li> <li>B sends a packet to A, because NAT considers this as a response, packet will be allowed to pass</li> </ul> <p>But problem of NAT is we don’t know the public port of A and B. So we need a third party to help us, this is a device at the public side can see both public side of A and B. It’s called STUN server.</p> <p>STUN server listens on a well-known port and when A and B want to establish a connection, they send a request to STUN server to get their public IP:port.</p> <p>Then A and B exchange their public IP:port and send a packet to each other to establish a connection.</p> <p>Because of endpoint independent, non-symmetric NAT always remaps the private IP:port to a fixed public IP:port, the port they get from STUN when sending request is the same when sending packet to each other.</p> <p>Let do a simple example with netcat:</p> <p>Server S’s IP: <em>14.123.124.125</em></p> <ol> <li>Server S listening on 3478/UDP (act as a STUN server)</li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-luvn</span> 3478
</code></pre></div></div> <ol> <li>Client A send a request to S on 3478/UDP</li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-vu</span> <span class="nt">-p</span> 50001 14.123.124.125 3478
</code></pre></div></div> <p>We can see the source IP:port is <strong><em>11.100.101.102:23241</em></strong></p> <ol> <li>Back to step 1</li> <li>Client B send a request to S on 3478/UDP</li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-vu</span> <span class="nt">-p</span> 50002 14.123.124.125 3478
</code></pre></div></div> <p>We can see the source IP:port is <strong><em>12.100.101.201:37261</em></strong></p> <p>Now we have known public IP:port of A and B</p> <p>Establish the P2P connection:</p> <ol> <li>A send a request to B on <strong><em>37261</em></strong></li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-vu</span> <span class="nt">-p</span> 50001 12.100.101.201 37261
</code></pre></div></div> <p>Nothing happened</p> <ol> <li>B send a request to A on <strong><em>23241</em></strong></li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-vu</span> <span class="nt">-p</span> 50002 12.100.101.201 23241
</code></pre></div></div> <p>Now A and B have established a connection. Type something on A, we can see it on B and vice versa.</p> <p>But this just solve the non-symmetric NAT, for symmetric which we cannot predict the public port, we need a relay server call TURN.</p> <p>This is the last resort when STUN technique doesn’t work.</p> <h3 id="stun-turn-and-ice">STUN, TURN and ICE</h3> <p>Interactive Connectivity Establishment (ICE) is a standard for using STUN and TURN to provide a solution for NAT traversal.</p> <p>They are used in WebRTC, VoIP and many P2P applications.</p> <p>Mesh VPN is a good example of using ICE to establish a P2P connection.</p> <h3 id="conclusion">Conclusion</h3> <p>In this article, we have discussed the concept of UDP hole punching and how it works, and what is STUN, TURN, ICE and how they resolve the NAT traversal problem.</p> <p>In case you have any questions, feel free to ask or share your opinion in the comment section.</p> <p>If you care about my VPN setup with Hub and Spoke, read <a href="/blog/2024/hub-spoke-vpn/">this article</a></p>]]></content><author><name></name></author><category term="networking"/><category term="p2p"/><category term="nat"/><category term="stun"/><category term="ice"/><category term="network"/><summary type="html"><![CDATA[UDP hole punching is a technique for establishing bidirectional UDP connections between two networked devices behind NATs.]]></summary></entry><entry><title type="html">Hub and Spoke VPN, how it solve my working problem</title><link href="https://www.dinhphu28.com/blog/2024/hub-spoke-vpn/" rel="alternate" type="text/html" title="Hub and Spoke VPN, how it solve my working problem"/><published>2024-11-29T03:59:00+00:00</published><updated>2024-11-29T03:59:00+00:00</updated><id>https://www.dinhphu28.com/blog/2024/hub-spoke-vpn</id><content type="html" xml:base="https://www.dinhphu28.com/blog/2024/hub-spoke-vpn/"><![CDATA[<h3 id="introduction">Introduction</h3> <p>Hub &amp; Spoke VPN is a VPN network topology that connects multiple remote peers (spokes) to a central location (hub) to provide secure communication between them.</p> <p>Spokes can only communicate with each other through the hub. The hub is a single point of failure, so if we want a reliable network, we need to increase the availability of the hub.</p> <p>In this post, we will discuss the Hub &amp; Spoke VPN and how it solve the problem of working activity in the remote area.</p> <h3 id="problem">Problem</h3> <p>I’m a software engineer usually working in the office. But sometimes I need to work remotely from home, coffee shop, or other place. And I also want to build a server that can be accessed from anywhere securely.</p> <h3 id="what-we-need">What we need</h3> <pre><code class="language-mermaid">flowchart TB
    subgraph TOPOLOGY["&lt;i class='mdi mdi-cloud-outline'&gt;&lt;/i&gt; Topology"]
        direction TB

        hub[&lt;i class='fa fa-network-wired'&gt;&lt;/i&gt; Hub]
        homesrv[&lt;i class='fa fa-server'&gt;&lt;/i&gt; Home Server Expose 443/TCP]
        officepc[&lt;i class='fa fa-desktop'&gt;&lt;/i&gt; Office Computer]
        laptop[&lt;i class='fa fa-laptop'&gt;&lt;/i&gt; My Laptop]
        phone[&lt;i class='fa fa-mobile'&gt;&lt;/i&gt; My Phone]
        internet[&lt;i class='mdi mdi-earth'&gt;&lt;/i&gt; Internet]
    end

    hub -.-&gt;|VPN Tunnel| laptop
    hub -.-&gt;|VPN Tunnel| phone
    hub -.-&gt;|VPN Tunnel| homesrv
    hub -.-&gt;|VPN Tunnel| officepc

    internet -.-&gt;|Public Access 443/TCP| hub
    hub ---|NAT 443/TCP via Tunnel| homesrv

</code></pre> <ul> <li>A secure &amp; manageable network to setup VPN server (hub), so I will use my home network.</li> <li>A device acts as a VPN server (hub), it can be an old computer, Raspberry Pi or any device that can run VPN server software.</li> <li>One or more VPN clients (spokes), in my case, they are my laptop, smartphone and a personal server, all of them are in other locations and in different private networks.</li> </ul> <p>I will use OpenVPN because it can be installed on many platforms and easy to use. Make sure you have enabled client to client communication.</p> <p>My hub is a Raspberry Pi running Raspbian OS and iptables (default).</p> <p>Install OpenVPN client on personal server, laptop and any device you want to join the VPN network.</p> <p>Connect the VPN clients to the VPN server (hub) using the OpenVPN client software, setup auto connect. Boom! Now you can access your home server or other devices in the VPN network.</p> <p>In case you want to access the internet though the hub, setup the VPN server to route all traffic though it.</p> <p>Because I have a server and want to publish my some services to the Internet, I will setup port forwarding (NAT) on the hub to forward the traffic to the server. To optimize the bandwidth, the server which only listens traffic from the hub, only routing traffic of VPN subnet via tun interface, default is to the Internet.</p> <p>For some work that I need the office’s computer and some resources in the office’s network, connect the office’s computer to the VPN network then start a proxy server on this computer.</p> <h3 id="use-cases">Use cases</h3> <p>I usually use this setup for:</p> <ul> <li>Securely Internet access when I’m in public places.</li> <li>Access my home server and office’s computer from anywhere.</li> <li>Communicate with other devices in the VPN network.</li> <li>Seamlessly work in the remote area.</li> <li>Publish services to the Internet with server at any location.</li> </ul> <p>With me, working almost on the CLI, so with neovim, tmux, ssh and other tools, I can work seamlessly anywhere, any device which have terminal emulator and internet connection. I call this setup Unified Working Environment.</p> <h3 id="pros--cons">Pros &amp; Cons</h3> <h4 id="pros">Pros</h4> <ul> <li>Centralized communication</li> <li>Cost effective</li> <li>Easy to control security</li> </ul> <h4 id="cons">Cons</h4> <ul> <li> <p>Single point of failure</p> <blockquote> <p>Because hub is the central point, if it goes down, all spokes will lose connection to each other.</p> </blockquote> </li> <li> <p>Bottleneck</p> <blockquote> <p>All traffic between spokes must go through the hub, so the hub can be a bottleneck. So if you have many spokes and need high bandwidth, you can consider a mesh network. I suggest Tailscale, it’s easy to use and setup and can be used for free.</p> </blockquote> </li> </ul> <h3 id="conclusion">Conclusion</h3> <p>In this article, I will show you my hub &amp; spoke VPN setup and how it helps me in my working activities. I hope you can find it useful and apply it to your work.</p> <p>If you have any questions, suggestions or your own setup, please leave a comment below.</p>]]></content><author><name></name></author><category term="networking"/><category term="vpn"/><category term="network"/><category term="security"/><summary type="html"><![CDATA[Hub & Spoke VPN is a VPN network topology that connects multiple remote peers (spokes) to a central location (hub) to provide secure communication between them.]]></summary></entry><entry><title type="html">Generate password with command line in Linux or macOS</title><link href="https://www.dinhphu28.com/blog/2024/generate-password-cli/" rel="alternate" type="text/html" title="Generate password with command line in Linux or macOS"/><published>2024-11-09T09:16:00+00:00</published><updated>2024-11-09T09:16:00+00:00</updated><id>https://www.dinhphu28.com/blog/2024/generate-password-cli</id><content type="html" xml:base="https://www.dinhphu28.com/blog/2024/generate-password-cli/"><![CDATA[<p>Most websites or application require a strong password that contains a mix of letters, numbers and special characters. And to make it more secure, it should be unique and randomly generated for each account. If you are using Linux or macOS and usually work with command line, you can use it to generate without installing any additional application.</p> <h3 id="using-devurandom-or-devrandom">Using /dev/urandom or /dev/random</h3> <p>This is my favorite way to generate password because <code class="language-plaintext highlighter-rouge">/dev/urandom</code> and <code class="language-plaintext highlighter-rouge">/dev/random</code> are available in most Unix-like operating systems.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt; /dev/urandom <span class="nb">tr</span> <span class="nt">-dc</span> <span class="s1">'[:graph:]'</span> | <span class="nb">head</span> <span class="nt">-c32</span><span class="p">;</span> <span class="nb">echo</span>
</code></pre></div></div> <p>This command will create a random password with printable character, length is 32.</p> <p>In case that alphabet &amp; numeric character, use <code class="language-plaintext highlighter-rouge">alnum</code> instead of <code class="language-plaintext highlighter-rouge">graph</code>.</p> <p>For more information, see <code class="language-plaintext highlighter-rouge">tr</code> <a href="https://linuxcommand.org/lc3_man_pages/tr1.html">manpage</a></p> <p>With macOS, an error occur when run above command because of UTF-8. Just add LC_ALL=C as below:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt; /dev/urandom <span class="nv">LC_ALL</span><span class="o">=</span>C <span class="nb">tr</span> <span class="nt">-dc</span> <span class="s1">'[:graph:]'</span> | <span class="nb">head</span> <span class="nt">-c32</span><span class="p">;</span> <span class="nb">echo</span>
</code></pre></div></div> <h4 id="random">Random</h4> <p>/dev/random takes the random values from the entropy pool. If the entropy pool is empty, it will be blocked reading.</p> <h4 id="urandom-unlimited-random">URandom (Unlimited Random)</h4> <p>/dev/urandom is similar to /dev/random but in case that entropy pool is empty, it generate value using hashing argorithm such as: SHA, MD5, …</p> <h4 id="in-term-of-security">In term of security</h4> <p>Because of high-quality randomness of /dev/random, it’s suitable for a password or a task focus on security.</p> <h3 id="using-openssl">Using openssl</h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rand <span class="nt">-base64</span> 32
</code></pre></div></div> <p>This command can only generate a base64 string password.</p> <h3 id="using-date-and-hashing">Using date and hashing</h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">date</span> | md5
</code></pre></div></div> <p>It similar to openssl command, but it’s not really random like openssl or /dev/urandom.</p> <h3 id="using-gpg">Using gpg</h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gpg <span class="nt">--gen-random</span> 1 32
</code></pre></div></div>]]></content><author><name></name></author><category term="utilities"/><category term="cli"/><category term="password-generating"/><category term="command-line"/><category term="linux"/><category term="macos"/><summary type="html"><![CDATA[If you usually work with command line in Linux or macOS, you can use it to generate password without installing any additional application.]]></summary></entry><entry><title type="html">Mình đã chuyển sang Fcitx5 thay vì IBus Bamboo và IBus Unikey</title><link href="https://www.dinhphu28.com/blog/2024/fcitx5-unikey-go-tieng-viet/" rel="alternate" type="text/html" title="Mình đã chuyển sang Fcitx5 thay vì IBus Bamboo và IBus Unikey"/><published>2024-04-06T09:16:00+00:00</published><updated>2024-04-06T09:16:00+00:00</updated><id>https://www.dinhphu28.com/blog/2024/fcitx5-unikey-go-tieng-viet</id><content type="html" xml:base="https://www.dinhphu28.com/blog/2024/fcitx5-unikey-go-tieng-viet/"><![CDATA[<h3 id="giới-thiệu">Giới thiệu</h3> <p>Trước đây lúc mới bước chân vào xài Linux cách đây 6 năm, mình đã bắt đầu với Ubuntu (GNOME) và IBus Unikey, sau một thời gian cảm thấy bộ gõ này không đáp ứng được nhu cầu của bản thân, mình đã tìm thấy một bộ gõ tương tự nhưng hỗ trợ nhiều tính năng hơn là IBus Bamboo và mình đã xài đến tận đầu năm 2024.</p> <p>Khoảng thời gian này mình thường xài 2 distro chính là Ubuntu rồi sau đó là Fedora với Desktop Environment là GNOME, mọi thứ vẫn hoạt động khá tốt đẹp, cho đến một ngày đầu năm 2024, mình quyết định chuyển sang xài KDE Plasma (Wayland) trên openSUSE Tumbleweed và đây là lúc mọi vấn đề bắt đầu.</p> <p>Sau khi cài đặt IBus Bamboo, chế độ gõ mặc định gạch chân được chọn và mình không có cách nào để chuyển chế độ gõ, chọn menu IBus trên menu bar lại không hoạt động bình thường, lúc hiển thị lúc không và cũng hiển thị không đúng. Thậm chí một khi menu hiển thị và hover vào chọn ‘Chế độ gõ mặc định’ thì ngay lập tức menu bị nháy một cái và hidden luôn, nếu vẫn cố gắng làm lại thì sẽ crash luôn menu bar.</p> <p>Một vấn đề nữa mình gặp phải là lúc đang để chế độ ‘Tiếng Việt’ do không chuyển được chế độ gõ mặc định nên gõ password bị lộ ra hết.</p> <p>Lúc này mình đã tìm đến một bộ gõ khác là <code class="language-plaintext highlighter-rouge">fcitx5</code> và mọi vấn đề được giải quyết.</p> <h3 id="cài-đặt">Cài đặt</h3> <ul> <li>fcitx5</li> <li>fcitx5-qt</li> <li>fcitx5-gtk</li> <li>fcitx5-unikey</li> <li>kcm-fcitx5</li> </ul> <p>Hiện mình đang xài openSUSE Tumbleweed và có thể cài từ các resources sau:</p> <p>Truy cập <a href="https://software.opensuse.org//download.html?project=openSUSE%3AFactory&amp;package=fcitx5">fcitx5</a>, <a href="">fcitx5-qt</a>, <a href="https://software.opensuse.org/package/fcitx5-gtk">fcitx5-gtk</a>, <a href="https://software.opensuse.org/download/package?package=fcitx5-unikey&amp;project=M17N">fcitx5-unikey</a>, <a href="https://software.opensuse.org/download/package?package=kcm5-fcitx&amp;project=openSUSE%3AFactory">kcm5-fcitx</a> tải xuống các files .ymp (click download) và click to install (đây cũng là một điểm mình khá thích openSUSE so với các distro khác từng xài trước đây) hoặc cũng có thể cài đặt qua script:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>zypper addrepo https://download.opensuse.org/repositories/openSUSE:Factory/standard/openSUSE:Factory.repo
<span class="nb">sudo </span>zypper addrepo https://download.opensuse.org/repositories/M17N/openSUSE_Tumbleweed/M17N.repo
<span class="nb">sudo </span>zypper refresh
<span class="nb">sudo </span>zypper <span class="nb">install </span>fcitx5
<span class="nb">sudo </span>zypper <span class="nb">install </span>fcitx-qt5
<span class="nb">sudo </span>zypper <span class="nb">install </span>fcitx5-gtk
<span class="nb">sudo </span>zypper <span class="nb">install </span>kcm5-fcitx
<span class="nb">sudo </span>zypper <span class="nb">install </span>fcitx5-unikey
</code></pre></div></div> <p>Để chọn bộ gõ, vào <code class="language-plaintext highlighter-rouge">System Settings</code> -&gt; <code class="language-plaintext highlighter-rouge">Virtual Keyboard</code> chọn fcitx5.</p> <p><strong><em>Lưu ý:</em></strong> Nếu xài Wayland, khi khởi động các app các bạn nhớ thêm các options <code class="language-plaintext highlighter-rouge">--enable-features=UseOzonePlatform --ozone-platform=wayland --enable-wayland-ime</code>.</p> <p>Ví dụ khi mình xài Typora:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Typora <span class="nt">--enable-features</span><span class="o">=</span>UseOzonePlatform <span class="nt">--ozone-platform</span><span class="o">=</span>wayland <span class="nt">--enable-wayland-ime</span>
</code></pre></div></div> <p>Tuy nhiên mình thường tạo/chỉnh sửa file <em>.desktop</em> rồi thêm options này vô luôn để mở app cho tiện.</p> <p>Mình viết bài này nhằm mục đích chia sẻ trải nghiệm gõ Tiếng Việt trên linux của cá nhân mình, đồng thời hy vọng có thể giúp các bạn cũng đã và đang gặp phải vấn đề tương tự như mình.</p> <p>Theo mình, IBus Bamboo vẫn là bộ gõ hoạt động rất tốt với GNOME vì một khoảng thời gian gần 6 năm mình vẫn hài lòng với nó, và fcitx5 là một lựa chọn tốt đối với KDE (ít nhất theo cảm nhận của mình hiện tại).</p> <p>Một số tài liệu tham khảo thêm:</p> <ul> <li>https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland</li> </ul>]]></content><author><name></name></author><category term="utilities"/><category term="fcitx5"/><category term="unikey"/><category term="vietnamese"/><summary type="html"><![CDATA[Bộ gõ Tiếng Việt thay thế cho IBus Unikey và IBus Bamboo]]></summary></entry></feed>