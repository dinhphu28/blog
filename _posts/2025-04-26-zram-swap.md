---
layout: post
title: ZRAM and how I deal with the memory usage in my Linux system
date: 2025-04-26 15:27:00+0700
description: ZRAM and how I deal with the memory usage in my Linux system.
tags: linux
categories: utilities
citation: true
giscus_comments: true
toc:
  beginning: true
---

## Introduction

I started using Linux in 2018 with a laptop with 4GB of RAM and 2 cores CPU.

That day, I was happy with the performance of my system, but as time went by, I started to feel that my system was getting slower and slower because of the memory usage. Sometimes, my system would freeze for a few seconds, and I had to wait for it to respond again.

So I think that I need to enable the swap to improve the performance of my system. But I don't know about the ZRAM and just enabled the disk swap.

Because of the SSD, it was fast, but I still felt that my system was not as fast as before, especially when I opened multiple applications at the same time.

For a long time, I thought that the swap was the only solution to improve the performance of my system. But after a while, I found the ZRAM. Then I started to learn about it and how to use it.

## What is ZRAM?

ZRAM is a Linux kernel module that creates compressed RAM-based block devices that can be used as swap space or as a general-purpose RAM disk.

This compressed block device can be used as a swap space. Yeah, you heard it right. It is a swap space that is stored in RAM instead of on the disk.

Until here, you may think that we need swap to expand the memory usage. But ZRAM swap is in RAM and the RAM capacity is limited. So why do we need ZRAM and how does it work?

## How does ZRAM swap work?

Instead of using the disk swap, the swap data is compressed and stored in RAM.

It allows storing more data in RAM. So instead of having 4GB of RAM, you can have 6GB of RAM with ZRAM.

In turn, it will improve the system performance because the data is stored in RAM, which is much faster than the disk swap.

But it takes CPU resources to compress and decompress the data.
So if you have a low-end CPU, it may not be a good idea to use ZRAM.
But with a modern CPU, it should not be a problem and you will feel as if your system has more RAM.

We have many compression algorithms to choose from, such as LZO, LZ4, ZSTD, and others.
But with me, ZSTD is the best choice because it has a good balance between speed and compression ratio. It has been chosen by openSUSE Tumbleweed as the default.

If you want to read more about ZRAM algorithms, check [here](https://www.kernel.org/doc/html/latest/admin-guide/mm/zram.html#compression-algorithms).

## Enabling ZRAM

For openSUSE Tumbleweed, enable ZRAM is easy. Just run the following command:
```sh
sudo zypper install systemd-zram-service && sudo zramswapon
```

For Debian/Ubuntu, you can install the `zram-config` package:
```sh
sudo apt install zram-config
sudo systemctl enable zram-config
sudo systemctl start zram-config
```

Because of ZRAM swap (data compression), data should be pushed into ZRAM as soon as possible. Swappiness should be `180`.

```bash
sudo sysctl vm.swappiness=180
```

With `zstd`, `vm.page-cluster` should be `0` because of decompression.

## Conclusion

I have been using ZRAM for a while now, and I can say that it has improved the performance of my system significantly.
At least, it sastisfies me for opening tens of tabs in the browser and running multiple applications at the same time.

Anyway, ZRAM is not a replacement for RAM.
It is just a way to improve the performance of your system by using the available RAM more efficiently when the system is under memory pressure.

If you have a large amount of RAM, you may not need ZRAM because it may affect the performance of your system negatively due to the CPU overhead of compressing and decompressing data.

But other than that, ZRAM is a great way to improve the performance of your system, especially if you have a low-end system with limited RAM.

Thank you for reading this post. I hope you find it helpful.

In case you have any questions or suggestions, feel free to leave a comment below.

Next time, we will discuss how some popular OS deal with the memory usage.

References:

- https://www.kernel.org/doc/html/latest/admin-guide/blockdev/zram.html
- https://dev.to/archerallstars/lets-fine-tune-your-zram-aka-free-ram-in-opensuse-with-zstandard-aka-zstd-4eap
