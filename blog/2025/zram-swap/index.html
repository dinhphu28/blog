<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> ZRAM and how I deal with the memory usage in my Linux system | Dinh Phu Nguyen dinhphu28 </title> <meta name="author" content="Dinh Phu Nguyen"> <meta name="description" content="ZRAM and how I deal with the memory usage in my Linux system."> <meta name="keywords" content="dinhphu28, Dinh Phu Nguyen, developer, software, java, spring boot, restful"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?4ba009165543dd6eb5a40d3cb4d65e78"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://www.dinhphu28.com/blog/2025/zram-swap/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Dinh Phu Nguyen dinhphu28 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/portfolio/">portfolio </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">ZRAM and how I deal with the memory usage in my Linux system</h1> <p class="post-meta"> May 30, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/linux"> <i class="fa-solid fa-hashtag fa-sm"></i> linux</a>     ·   <a href="/blog/category/utilities"> <i class="fa-solid fa-tag fa-sm"></i> utilities</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"><a href="#introduction">Introduction</a></li> <li class="toc-entry toc-h2"><a href="#what-is-zram">What is ZRAM?</a></li> <li class="toc-entry toc-h2"><a href="#how-does-zram-swap-work">How does ZRAM swap work?</a></li> <li class="toc-entry toc-h2"><a href="#enabling-zram">Enabling ZRAM</a></li> <li class="toc-entry toc-h2"><a href="#conclusion">Conclusion</a></li> </ul> </div> <hr> <div id="markdown-content"> <h2 id="introduction">Introduction</h2> <p>I started using Linux in 2018 on a laptop with 4GB of RAM and a dual-core CPU.</p> <p>At first, I was happy with how my system performed. But over time, I noticed it becoming slower, especially as memory usage increased. Occasionally, the system would freeze for a few seconds, and I had to wait for it to respond again.</p> <p>I thought enabling swap might help improve performance. At the time, I didn’t know about ZRAM, so I simply enabled traditional disk-based swap.</p> <p>Thanks to the SSD, swap access was relatively fast—but still, the system didn’t feel as responsive as before, especially when I had multiple applications open.</p> <p>For a long time, I believed swap was the only solution to extend memory. Then I discovered <strong>ZRAM</strong>, and I began learning how it works and how to make use of it.</p> <h2 id="what-is-zram">What is ZRAM?</h2> <p><strong>ZRAM</strong> is a Linux kernel module that creates compressed, RAM-based block devices. These virtual devices can be used either as swap space or as general-purpose RAM disks.</p> <p>Yes, you read that right—<strong>swap space stored in RAM</strong> instead of on disk.</p> <p>At this point, you might be thinking: <em>“Isn’t swap supposed to expand available memory? Why would we use our already limited RAM for it?”</em></p> <p>That’s where ZRAM’s magic lies. By compressing data before storing it in RAM, ZRAM allows you to store more data in the same amount of memory. This makes your system feel like it has more RAM—without touching your disk.</p> <h2 id="how-does-zram-swap-work">How does ZRAM swap work?</h2> <p>Unlike traditional swap, which stores data on disk, <strong>ZRAM compresses and stores swap data directly in RAM</strong>.</p> <p>This means you can fit more data into your available memory. For example, with 4GB of physical RAM, ZRAM might effectively give you the equivalent of 6GB—depending on the compressibility of your data.</p> <p>Since RAM is significantly faster than any disk, this results in <strong>better system responsiveness</strong>, especially under memory pressure.</p> <p>Of course, compression and decompression use CPU resources. On low-end CPUs, this overhead might cause a performance hit. But on modern processors, it’s usually negligible—and the benefit of having “more RAM” tends to outweigh the cost.</p> <p>ZRAM supports several compression algorithms, such as <strong>LZO</strong>, <strong>LZ4</strong>, <strong>ZSTD</strong>, and others. Personally, I prefer <strong>ZSTD</strong> because it strikes a good balance between speed and compression ratio. It’s also the default in <strong>openSUSE Tumbleweed</strong>.</p> <h2 id="enabling-zram">Enabling ZRAM</h2> <p>For openSUSE Tumbleweed, enable ZRAM is easy. Just run the following command:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>zypper <span class="nb">install </span>systemd-zram-service <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>zramswapon
</code></pre></div></div> <p>For Debian/Ubuntu, you can install the <code class="language-plaintext highlighter-rouge">zram-config</code> package:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>zram-config
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>zram-config
<span class="nb">sudo </span>systemctl start zram-config
</code></pre></div></div> <p>Because of ZRAM swap (data compression), data should be pushed into ZRAM as soon as possible. Swappiness should be <code class="language-plaintext highlighter-rouge">180</code>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>sysctl vm.swappiness<span class="o">=</span>180
</code></pre></div></div> <p>With <code class="language-plaintext highlighter-rouge">zstd</code>, <code class="language-plaintext highlighter-rouge">vm.page-cluster</code> should be <code class="language-plaintext highlighter-rouge">0</code> because of decompression.</p> <h2 id="conclusion">Conclusion</h2> <p>I’ve been using <strong>ZRAM</strong> for a while now, and I can confidently say it has significantly improved my system’s performance. At the very least, it allows me to open dozens of browser tabs and run multiple applications without noticeable slowdowns.</p> <p>That said, ZRAM is <strong>not a replacement for physical RAM</strong>. Instead, it’s a smart way to make better use of the RAM you already have—especially under memory pressure.</p> <p>If your system has plenty of RAM, ZRAM might not be necessary. In fact, the CPU overhead for compression and decompression could slightly degrade performance in such cases.</p> <p>But if you’re working with a <strong>low-end system or limited RAM</strong>, ZRAM can be a game-changer. It provides a noticeable performance boost with minimal setup.</p> <p>Thanks for reading! I hope you found this post helpful.</p> <p>If you have any questions or suggestions, feel free to leave a comment below.</p> <p><strong>Next time</strong>, we’ll look at how some popular operating systems handle memory management and swap strategies.</p> <p>References:</p> <ul> <li>https://www.kernel.org/doc/html/latest/admin-guide/blockdev/zram.html</li> <li>https://dev.to/archerallstars/lets-fine-tune-your-zram-aka-free-ram-in-opensuse-with-zstandard-aka-zstd-4eap</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/generate-password-cli/">Generate password with command line in Linux or macOS</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/hub-spoke-vpn/">Hub and Spoke VPN, how it solve my working problem</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/udp-hole-punching/">P2P - UDP Hole Punching</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/fcitx5-unikey-go-tieng-viet/">Mình đã chuyển sang Fcitx5 thay vì IBus Bamboo và IBus Unikey</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"dinhphu28/blog","data-repo-id":"R_kgDOLkuMeg","data-category":"Comments","data-category-id":"DIC_kwDOLkuMes4CeO1S","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dinh Phu Nguyen. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-LJ1DEQETXK"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LJ1DEQETXK");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>